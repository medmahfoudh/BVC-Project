from llmware.models import ModelCatalog

def ask(query, context):
    qwen2_rag_finetunes = ["dragon-qwen-7b-gguf", "bling-qwen-1.5b-gguf", "bling-qwen-0.5b-gguf"]

    qwen2_rag = ModelCatalog().load_model("dragon-qwen-7b-gguf", temperature=0.0, sample=False, use_gpu=False, max_output= 200)
    
    #context = """Metadata:\nwieland crm \n \n20. Mar. 2025\n\nAccount Info:\nChocoLuxe GmbH \nParkstraße 33 / 86021 / Kassel / DE\n\nAccount ID:\n50000762185\n\nLast Visit:\n26.Jan.2025\n\nSBU:\nChocolate bars\n\nCustomer Segment:\n\n\nPayment Terms:\n14 days after date of invoice, net\n\nDate:\n26. Jan. 2025\n\nLocation:\nWerk Vöhringen\n\nSubject:\nNeukunde ChocoLuxe – Projekt SchokoGigant\n\nOwner:\nAndreas Becker\n\nAttendees:\n- \nAndreas Becker (PR.CHOC) \n- \nAndreas Novak (Einkaufsabteilung; Abteilungsleiter) \n- \nLisa Reed (Einkaufsabteilung: Head of Supply Chain) \n- \nRafaela Costa \n- \nSven Eriksson (Einkaufsabteilung; Sachbearbeiter ID) \n- \nMiguel Petrov (Testing)\n\nVisit Type:\nBusiness Initiation\n\nResult:\nResult \n \n- Gemeinsame Realisierung SchokoGigant-Projekt vereinbart (Lohnröstung BestChocolate) \n- Kakaobeschaffung ab Mitte 2025 soll auf BestChocolate umgestellt werden  \n- Termin Besuch in Kassel zum allgemeinen Ausbau der Geschäftsbeziehung vereinbaren \n \n \n \n\nwieland crm \n \n20. Mar. 2025\n\nExecutive Summary:\nExecutive Summary \n \n- Technische Hintergründe geklärt \n- Herausforderungen Anlieferungen (Online-Avisierung) geklärt \n- Standards bezüglich Ladungssicherung / Verpackung fixiert (ToDo Kunde) \n- Hochlauf + Start der Serien-Röstungen ab April 2025 vorgesehen\n\nBusiness Situation:\nBUSINESS SITUATION OF THE CUSTOMER AND GENERAL INFORMATION \n- Zuletzt zahlreiche Projekte in der Lebensmittelindustrie durch ChocoLuxe konkretisiert \n- Ausblick und Geschäftsverlauf nach herausfordernden Jahren wieder positiv\n\nMARKET ENVIRONMENT:\nMARKET ENVIRONMENT OF THE CUSTOMER \nDie ChokoLuxe GmbH mit Sitz in Kassel ist ein führender Hersteller von hochwertigen \nSchokoladenprodukten und bietet Lösungen für die Süßwarenindustrie. Das Unternehmen \nist auf die Entwicklung und Produktion von Groß-, Mittel- und Kleinserien von Schokoladen, \nsowie auf speziell veredelte Schokoladenprodukte spezialisiert.  \nDurch allgemein ansteigende Investitionen in die Lebensmittelindustrie und innovative \nSüßwaren erweitern sich die Einsatzfelder der Produkte.  \nAllgemeine Nachfrage aktuell sehr gut.\n\nDemand Info:\nDEMAND, GB´s SHARE OF DEMAND, COMPETITION \n- Kakaobeschaffung ChocoLuxe läuft aktuell im Schwerpunkt über Handel  \n- Parallele Geschäftsanbahnung Firma Faller (CH) als Zulieferer an ChocoLuxe (Kakao über \nBestChocolate)\n\nPOTENTIAL:\nPOTENTIAL FOR FURTHER BUSINESS / NEW PROJECTS \n- Aktuelles Projekt für SchokoGigant-Konzern \n- Einsatz Schokoladenriegel für Großveranstaltungen (Investitions-Offensive für Events und \nFeiern) \n- Kakaobeschaffung lief zuletzt über Handel, Umstellung auf BestChocolate angestrebt \n(gesonderte Verhandlung) \n- Zulieferer Fa. Tramer + Fa. Schlinger werden gesondert kontaktiert \n(Update 20.02. Erste Auslieferung Schokoriegel an Fa. Tramer, Qualifizierung erfolgt) \n \n \n\nwieland crm \n \n20. Mar. 2025\n\nCurrent Topics:\nCURRENT TOPICS \nChocoLuxe wünscht Lohn-Röstungen von Kakaobohnen für Schokoladenriegel (Endkunde \nSchokoGigant-Konzern) \nParameter und Qualifizierung nach erstem Röstvorgang erfolgreich bestanden \nFestgelegtes Programm "1h - 325°C" bringen gewünschten Effekt \nProjekt-Hochlauf ab April geplant, dann ca. 7 Röstungen pro Monat (DB3Ge pro Röstung \n1.900 €) \nProjekt-Rahmen für 2025: ca. 40 Röstungen // Laufzeit aktuell bis Ende 2026 geplant  \n \n1 Röstung = 12 Ausleitungen Variante 1 + 12 Ausleitungen Variante 2 \n \nUpdate 10.03.2025: Forecast + Time-Line wird finalisiert und an BestChocolate kurzfristig \nkommuniziert \nAuftrag für Röstung SchokoGigant erhalten - 2 Ofen-Ladungen = 40 Ausleitungen \n(11.03.2025) (Zwei Ausleitungstypen in gleicher Menge) \nDiese Röstungen gehören zur Phase 1 (Hochlauf Projekt) und sind nicht in angehängter \nTime-Line enthalten.\n\nFurther Topics:\nFURTHER TOPICS / CUSTOMER SATISFACTION \nToDos: \n- Übermittlung der Anforderungen Ladungssicherung + Verpackung  \n- Fragestellungen + Anforderungen mit Kunden klären (erl. / Gesonderte Info an PR.CHOC)\n\nMarket Trends:\nMarket/Business Trends \n \nSurvey Name \nQuestion \nAnswer \nCustomer satisfaction \nQUALITY OF OUR PRODUCTS \nDELIVERY RELIABILITY \nSERVICE \nVery good \nVery good \nVery good \n \n \n\nwieland crm \n \n20. Mar. 2025 \n \n \nAttachment \n \nAlternative Title \nDocument Type \nVisit Report - ChocoLuxe GmbH – 26.01.2025.pdf \nZusammenfassung \nÜbersicht_Zeitplan_SchokoGigant.xlsx \nStandardanlage\n\nDemands:\n"""

    response = qwen2_rag.inference(query, add_context=context)

    print("\nqwen2-rag response: ", response["llm_response"])
    
    return (response["llm_response"])

